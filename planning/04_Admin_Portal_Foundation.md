# 阶段4: 管理后台基础 (Admin Portal Foundation)

## 1. 阶段目标
- 搭建后台管理系统的基础框架。
- 实现安全的管理员登录功能。
- 创建一个包含核心KPI数据卡片的仪表盘（Dashboard）首页。
- **产出**: `admin-login.html` 和 `admin-dashboard.html` 的基本框架和功能。

## 2. 包含的用户故事
- **作为一名HR或管理员**, 我希望能通过一个专属的登录页面，使用我的账号和密码安全地进入管理后台。
- **作为一名HR或管理员**, 登录后我希望能立刻看到一个清晰的仪表盘，上面有最重要的招聘数据（比如今天收到了多少新简历），以便我能快速了解当前的工作概况。

## 3. 功能需求
- **登录页 (`admin-login.html`)**:
    - **表单字段**:
        - `用户名/邮箱` (文本输入，必填)
        - `密码` (密码输入，必填)
    - **功能**:
        - "记住我" 复选框。
        - "登录"按钮。
    - **安全**: 登录失败时（如用户名或密码错误）需给出明确提示。

- **后台整体布局**:
    - **侧边导航栏 (Sidebar)**:
        - 包含指向"仪表盘"、"职位管理"、"候选人管理"等主要模块的链接。
        - 当前所在模块的导航项应有高亮激活状态。
        - 底部应有"退出登录"的链接。
    - **主内容区 (Main Content)**:
        - 用于展示各个模块的具体内容。

- **仪表盘页面 (`admin-dashboard.html`)**:
    - **核心KPI卡片**:
        - 以醒目的卡片形式，静态展示以下关键指标的"占位"数据：
            - `待处理简历`
            - `进行中面试`
            - `活跃职位数`
            - `人才库总览`
    - **近期申请列表**:
        - 以表格形式，静态展示几条最新的候选人申请记录"占位"数据，包含姓名、申请职位、投递时间。
    - **招聘漏斗图**:
        - 预留一个区域给"招聘漏斗图"，在本阶段可以用一张图片占位。

## 4. 验收标准
- 管理员可以通过用户名和密码成功登录后台。
- 登录后，可以看到包含侧边栏和主内容区的后台布局。
- 仪表盘页面成功显示了含有占位数据的KPI卡片和列表。
- 侧边栏的链接可以点击，但指向的页面（职位/候选人管理）在本阶段可以是空页面。

## 5. 技术实现说明
- **认证服务**:
    - 使用 **Supabase Auth** 来管理管理员账号（可以使用邮件/密码或OAuth提供商）。
    - 登录成功后，将返回的 `access_token` 存储在HttpOnly Cookie中，以提高安全性。
- **路由保护 (Middleware)**:
    - 在Next.js中使用 **Middleware** (`middleware.js`) 来保护所有 `/admin/**` 路径。
    - 中间件会检查请求中是否存在有效的Supabase session/cookie。如果验证失败，则将用户重定向到 `/admin/login` 页面。
- **数据查询**:
    - 使用 `supabase-js` 客户端，配合 `getServerSideProps` 在页面加载时从服务端获取看板所需的数据，确保数据总是最新的，且请求是安全的。
- **图表库**:
    - 可以引入 `Chart.js` 或 `Recharts` 等库来使数据可视化。
- **数据看板 (`admin/dashboard`)**:
    - **布局**: 使用网格布局（Grid）展示多个指标卡片。
    - **指标卡片**:
        - **使用 `Card` 组件**，包含 `CardHeader`, `CardContent`, `CardFooter`。
        - **数据来源**: 聚合自 `jobs` 和 `candidates` 表。

## 6. 验收标准 (Acceptance Criteria)
- ✅ 未登录用户访问 `/admin/dashboard` 或任何后台页面时，会被自动重定向到 `/admin/login`。
- ✅ 使用有效的管理员账号可以成功登录，并被带到数据看板页面。
- ✅ 数据看板上的 `Card` 组件能正确显示三个核心指标。
- ✅ 后台的侧边栏导航和顶部栏能正确显示。
- ✅ 点击"退出登录"按钮后，用户的登录状态被清除，并被重定向回登录页。 