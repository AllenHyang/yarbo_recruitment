# 阶段3: 核心申请流程 (Core Application Flow)

## 1. 阶段目标
- 实现候选人从点击"立即申请"到成功提交简历的完整闭环。
- **产出**: 一个功能完善的申请表单，并能在投递成功后给予用户明确反馈。

## 2. 包含的用户故事
- **作为一名求职者**, 当我找到心仪的职位后，我希望能在一个简洁的表单上快速填写我的基本信息，并上传我的简历文件，以便完成申请。
- **作为一名求职者**, 在我点击"提交"后，我希望能立即得到一个清晰的成功提示，并被告知后续的大致流程，以减少我的不确定性。
- **作为一名候选人**, 我希望在提交申请后，能立刻看到一个确认成功的提示，让我知道我的申请已经被收到了。

## 3. 功能需求
- **申请表单**:
    - **交互形式**: 建议使用 `Dialog` 或 `Sheet` 组件，在职位详情页弹出，避免页面跳转。
    - **字段**:
        - `姓名`: 使用 `Input` 组件。
        - `手机号`: 使用 `Input` 组件。
        - `邮箱`: 使用 `Input` 组件。
        - `期望薪资`: 使用 `Input` 组件。
        - `简历附件`: 使用 `Input type="file"` 并自定义样式。
    - **标签**: 所有输入框都应有清晰的 `Label` 组件。
    - **表单验证**:
        - 所有字段均为必填。
        - 手机号和邮箱需符合格式规范。
        - 在用户提交前进行前端验证，并给出明确的错误提示。
- **提交逻辑**:
    - 点击"提交申请"后，按钮应变为"提交中..."状态，防止重复提交。
    - 申请信息（包括简历文件URL）被保存到Supabase数据库。
- **成功提示**:
    - 提交成功后，在当前页显示一个醒目的成功消息，例如："申请已成功提交！我们将尽快与您联系。"
    - 提示中可包含一个链接，指向"个人申请中心"（在后续阶段实现）。

## 4. 技术实现说明
- **Supabase 数据模型**:
    - 需要在Supabase中创建 `candidates` 表。
    - **`candidates` 表结构建议**:
        - `id` (uuid, 主键)
        - `created_at` (timestamp)
        - `name` (text)
        - `phone` (text)
        - `email` (text)
        - `expected_salary` (text)
        - `resume_url` (text)
        - `job_id` (uuid, 外键关联 `jobs` 表)
        - `status` (text, 默认值为 '已投递')
- **文件上传**:
    - 使用 `supabase-js` 客户端库提供的 `storage` API。
    - 简历文件应上传到Supabase Storage中一个名为 `resumes` 的Bucket。
    - Bucket需要设置好相应的访问策略，确保安全性。
- **前端状态管理**: 使用 `react-hook-form` 或类似库来处理复杂的表单状态和验证逻辑，可以与 `Shadcn/UI` 的组件无缝集成。
- **Shadcn/UI 组件**:
    - **添加命令**: `npx shadcn@latest add dialog sheet input label`
    - 使用 `Dialog` 或 `Sheet` 作为表单容器。
    - 使用 `Input` 和 `Label` 构建表单字段。

## 5. 验收标准 (Acceptance Criteria)
- ✅ 申请表单能以 `Dialog` 或 `Sheet` 的形式正确弹出。
- ✅ 申请表单能正确渲染所有必填字段。
- ✅ 简历上传功能正常，能正确处理支持的格式和文件大小限制。
- ✅ 前端表单验证按要求工作，对无效输入能给出清晰的错误提示。
- ✅ 提交表单后，一条包含所有填写信息的新记录被成功插入到Supabase的 `candidates` 表中。
- ✅ 简历文件被成功上传到Supabase Storage，并且其URL被正确记录在 `candidates` 表的 `resume_url` 字段。
- ✅ 提交成功后，页面上会显示确认成功的消息。
- ✅ 在网络较慢的情况下，提交按钮的"提交中"状态能正确显示。

## 6. 验收标准
- 用户可以成功填写所有必填信息并上传一份简历文件。
- 表单有正确的前端验证逻辑。
- 提交成功后，用户能看到清晰的成功反馈信息。
- （后端）服务器能够接收到表单数据和简历文件（本阶段只定义接口，可不做实现）。 