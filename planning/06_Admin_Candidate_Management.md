# 阶段6: 管理后台 - 候选人管理

## 1. 阶段目标
- 为HR和面试官提供一个强大、易用的候选人筛选和评估工作台。
- 实现对候选人从"收到简历"到"流程结束"的全过程跟踪与管理。
- **产出**: 功能完善的 `admin-candidates.html` 页面。

## 2. 包含的用户故事
- **作为一名HR**, 我希望能在一个列表里看到所有申请者，并能按我关心的维度（比如申请的职位、当前的状态）进行快速筛选和搜索。
- **作为一名HR**, 我想能直接在网页上预览候选人的简历，而不需要每次都下载一个文件。
- **作为一名面试官**, 在面试后，我希望能方便地给候选人打一个星级评分，并写下我的面试评价，以便HR和其他面试官参考。
- **作为一名HR**, 当我决定让一个候选人进入下一轮时，我希望能简单地修改一下他的状态，然后系统能自动通知到候选人。

## 3. 功能需求
- **候选人列表页 (`admin-candidates.html`)**:
    - **页面布局**: 采用功能强大的表格（Table）布局。
    - **筛选与搜索**:
        - **筛选器**:
            - 按`申请职位`筛选。
            - 按`候选人状态`筛选 (待筛选, 面试中, 已拒绝等)。
        - **搜索框**: 按`候选人姓名`或`联系方式`进行模糊搜索。
    - **候选人表格**:
        - **列定义**:
            - `候选人信息`: 姓名、联系方式。
            - `申请职位`和`投递时间`。
            - `当前状态`: 使用**可交互的下拉菜单**，允许HR直接在表格中修改。
            - `综合评分`: 使用**可交互的星级评分组件**（1-5星）。
            - `操作`按钮组。
        - **表格行操作**:
            - **`查看简历`**: 点击后以内嵌Iframe或新标签页形式，在线预览简历文件。
            - **`添加备注`**: 点击后弹出模态框，允许HR和面试官添加对候选人的私密评论。
            - **`测评报告`**: （在此阶段为占位按钮）点击后应跳转到候选人的测评报告页。

- **自动化关联**:
    - 当HR在表格中修改候选人的状态时（例如，从"待筛选"改为"已安排面试"），系统应能（在未来）触发一个预设的邮件/短信通知，告知候选人其申请状态已更新。本阶段只需完成前端状态的变更即可。

## 4. 验收标准
- HR可以在列表中看到所有（静态/模拟的）候选人数据。
- 筛选器和搜索框功能正常。
- HR可以直接在表格中修改候选人的状态和星级。
- 点击"查看简历"和"添加备注"能正确弹出相应的功能（简历内容和备注信息可以是静态的）。

## 5. 技术实现说明
- **Supabase 数据模型**:
    - 核心依赖 `candidates` 表。
    - **`candidates.status` 字段**: 需要定义一个清晰的状态枚举值，例如: '已投递', '筛选通过', '面试中', 'Offer', '已入职', '已归档'。
    - **`notes` 表 (可选，推荐)**: 可以创建一个 `notes` 表用于存储内部备注。
        - `id`, `created_at`, `candidate_id` (外键), `author_id` (外键关联用户表), `content` (text)。
        - 这样可以记录是谁在什么时间发表的评论。
- **简历访问**:
    - 下载/预览简历的功能，需要调用Supabase Storage的API，生成一个有时效性的、安全的签名URL (`signedURL`)，而不是直接暴露文件的公共URL。
- **交互优化**:
    - 修改候选人状态等频繁操作，应在不刷新整个页面的情况下完成（异步请求），并给与用户即时反馈。同样，`useSWR` 或 `React Query` 是实现此功能的优秀工具。
- **Shadcn/UI 组件**:
    - **添加命令**: `npx shadcn@latest add table dropdown-menu select avatar dialog sheet button textarea`
    - 使用 `Table` 和 `Avatar` 构建主列表。
    - 使用 `Select` 进行筛选。
    - 使用 `Dialog` 或 `Sheet` 展示候选人详情。

## 6. 验收标准 (Acceptance Criteria)
- ✅ 候选人管理页面能以 `Table` 形式正确展示所有候选人的列表。
- ✅ 搜索和 `Select` 筛选功能可以按预期工作。
- ✅ 点击 `DropdownMenu` 中的"下载简历"可以成功获取到该候选人的简历文件。
- ✅ 在详情页中，可以成功修改候选人的招聘状态。
- ✅ HR可以成功添加、查看内部备注。
- ✅ 从职位管理页跳转过来时，能自动筛选出对应职位的候选人。 