# 阶段9: 候选人测评模块

## 1. 阶段目标
- 为招聘流程增加一个标准化的在线心理测评环节。
- 候选人完成测评后，可以获得一份可视化的个人报告。
- HR和面试官可以在后台方便地查阅这份报告。
- **产出**: `assessment.html`, `assessment-report.html` 页面，以及在 `admin-candidates.html` 和 `status.html` 中的集成入口。

## 2. 包含的用户故事
- **作为一名HR**, 我希望能有一个标准化的测评工具，来帮助我更客观、多维度地了解候选人的潜力和特质，作为简历和面试之外的补充。
- **作为一名候选人**, 我愿意花一些时间完成一个有趣的测评，并且我希望能看到一份关于我自己的、有价值的分析报告。
- **作为一名面试官**, 在面试一位候选人之前，我希望能快速地看一下他的测评报告，这能帮助我找到一些和他沟通的切入点。

## 3. 功能需求
- **测评引导**:
    - 在候选人成功投递简历后，应有明确的引导，鼓励其继续完成在线测评。
    - 也可以通过邮件/短信发送测评链接。

- **测评问卷页 (`assessment.html`)**:
    - **布局**: 以清晰的列表形式展示所有测评题目。
    - **题目类型**: 主要为单项选择题，**使用 `RadioGroup` 组件**。

- **测评报告页 (`assessment-report.html`)**:
    - **布局**: **使用 `Card` 组件** 作为报告容器。
    - **可视化**:
        - 包含多个维度的评分（如：逻辑思维、学习能力、团队协作等），**每个维度使用 `Progress` 组件展示得分**。
        - 使用 **雷达图** 进行可视化展示，直观反映候选人的能力分布。
        - 提供综合评语和建议。

- **集成整合**:
    - **候选人端 (`status.html`)**:
        - 在个人中心的右侧边栏，应有一个"我的测评"卡片，提供链接，方便候选人随时回顾自己的报告。
    - **管理后台 (`admin-candidates.html`)**:
        - 在候选人列表的"操作"列，为已完成测评的候选人增加一个"测评报告"按钮，点击后可直接查看该候选人的完整版报告。

## 4. 验收标准
- 候选人可以完整地走通"开始测评 -> 答题 -> 查看报告"的流程。
- 测评报告页的雷达图可以正确（静态）显示。
- 在候选人个人中心和后台候选人列表中，都有明确的入口可以访问到测评报告。

## 5. 技术实现说明
- **Supabase 数据模型**:
    - **`assessments` 表**:
        - `id` (uuid, 主键)
        - `candidate_id` (uuid, 外键)
        - `status` (text, '待完成'/'已完成')
        - `completed_at` (timestamp)
        - `scores` (jsonb, 存储各维度得分, e.g., `{"logic": 85, "learning": 90, ...}`)
        - `report_summary` (text, 存储综合评语)
- **测评流程**:
    - HR在后台为某个候选人"发起测评"后，会在 `assessments` 表创建一条新记录，状态为"待完成"。
    - 候选人通过个人中心入口进入测评页，完成题目后，前端计算得分，并将结果和状态更新到数据库。
- **图表库**:
    - 测评报告页的雷达图，可以使用 `Chart.js` (配合 `react-chartjs-2`) 或 `Recharts` 来实现。数据来源于 `assessments` 表中的 `scores` 字段。
- **Shadcn/UI 组件**:
    - **添加命令**: `npx shadcn@latest add radiogroup card progress`
    - 使用 `RadioGroup` 构建问卷题目。
    - 使用 `Card` 和 `Progress` 构建测评报告。
- **页面权限**:
    - 测评报告页应受保护，只有关联的候选人或管理员才能访问。这可以通过在 `getServerSideProps` 中验证用户身份和权限来实现。

## 6. 验收标准 (Acceptance Criteria)
- ✅ 候选人可以在个人中心看到"开始测评"的入口（当其测评状态为'待完成'时）。
- ✅ 测评题目可以正常显示和作答（使用 `RadioGroup`）。
- ✅ 完成测评后，得分和评语被正确保存在Supabase的 `assessments` 表中。
- ✅ 候选人和管理员都可以通过各自的入口，查看到包含雷达图、`Progress`条和评语的可视化报告。
- ✅ 雷达图能准确反映 `scores` 字段中的数据。
- ✅ 无权限的用户无法直接通过URL访问他人的测评报告。 