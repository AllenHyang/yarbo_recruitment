# 阶段10: 高级人才关系与未来规划

## 1. 阶段目标
- 从"招聘"思维转向"人才关系经营"思维，构建与潜在候选人的长期联系。
- 规划平台的未来智能化升级路径。
- **产出**: 实现人才库订阅功能，并为未来的V2.0版本做好产品定义。

## 2. 包含的用户故事
- **作为一名对Yarbo很感兴趣但暂时没有合适职位的求职者**, 我希望能先订阅我感兴趣的职位类别（比如"市场营销"），当有新职位发布时，能第一时间邮件通知我。
- **作为一名曾经投递过Yarbo的候选人**, 当我再次来访问时，我希望平台能记住我，并允许我用以前的资料一键申请新的职位，而不是所有信息都重填一遍。
- **作为一名HR**, 我希望系统能帮我分析简历，自动给候选人打上"精通Python"、"有5年管理经验"这样的标签，以提高我的筛选效率。

## 3. 功能需求 (V1.5)
- **人才社区 / 人才库订阅功能**:
    - **入口**:
        - 在首页或职位列表页，为暂时找不到合适职位的用户提供一个醒目的入口。
        - 例如一个"人才社区"模块，引导语："暂时没有心仪的职位？加入我们的人才库，让机会来找你！"
    - **订阅表单**:
        - **字段**:
            - `姓名`
            - `邮箱` (用于接收通知)
            - `感兴趣的职位类别` (多选，如"技术"、"产品"、"市场")
            - `简历` (可选上传)
        - **提交后反馈**: 告知用户已成功加入人才库。
- **后台人才库管理**:
    - 在管理后台增加"人才库"模块。
    - HR可以查看所有加入人才库的候选人信息。
    - HR可以根据职位类别筛选人才库中的候选人，并向他们主动发送职位邀请。

## 4. 未来规划 (V2.0 - 智能化平台)
- **智能职位推荐**:
    - **候选人端**: 对于再次访问的候选人，根据其历史投递记录和简历信息，在首页主动推荐可能感兴趣的新职位。
- **一键申请 (复用资料)**:
    - **候选人端**: 如果系统识别出是历史候选人，当他申请新职位时，会自动填充他上一次的简历信息，并允许他快速修改和提交。
- **简历智能解析**:
    - **管理后台**: 当HR上传或收到一份新简历时，系统能自动解析简历内容，提取出关键信息，如：
        - `工作年限`
        - `毕业院校`
        - `技能标签` (如 Python, C++, TensorFlow)
        - `职级`
    - 这些信息将作为高级筛选条件，极大提升HR的人岗匹配效率。
- **邮件通知**:
    - **触发条件**: 候选人状态发生关键变更时（如：筛选通过、收到面试邀请）。
    - **邮件模板**: 设计简洁、专业的邮件模板。
    - **内容**: 包含候选人姓名、申请职位和最新的状态信息。

## 5. 技术实现说明
- **Supabase 数据模型**:
    - **`job_subscriptions` 表**:
        - `id` (uuid, 主键)
        - `email` (text)
        - `keywords` (text[]) (职位关键词数组, e.g., ['前端', '上海'])
        - `created_at` (timestamp)
- **职位订阅实现**:
    - 用户提交订阅后，在 `job_subscriptions` 表中创建一条记录。
- **邮件通知实现 (Supabase Edge Functions)**:
    - **触发器**: 在Supabase的 `jobs` 表上设置一个数据库触发器（Trigger）。当有新职位插入 (`INSERT`) 且其 `status` 为 '发布中' 时，该触发器调用一个边缘函数。
    - **边缘函数 (`Edge Function`)**:
        1.  函数被触发后，获取到这个新职位的信息（标题、地点等）。
        2.  查询 `job_subscriptions` 表，找出所有匹配该职位关键词的订阅者邮箱。
        3.  调用一个邮件服务（如 Resend, SendGrid）的API，向所有匹配的订阅者批量发送新职位通知邮件。
    - **状态变更通知**: 可以在 `candidates` 表上设置类似的触发器，当 `status` 字段更新 (`UPDATE`) 时，触发一个函数，向该候选人发送状态更新邮件。

## 6. 验收标准 (Acceptance Criteria)
- ✅ 用户可以在前台页面成功提交职位订阅，并在数据库中生成相应记录。
- ✅ 当HR在后台发布一个新职位时，所有订阅了相关关键词的用户都能收到邮件通知。
- ✅ 当HR在后台将某候选人状态从"已投递"变更为"筛选通过"时，该候选人能收到一封状态变更的通知邮件。
- ✅ 邮件内容正确，包含职位/状态等动态信息。
- ✅ 邮件的发送过程是自动化的，无需人工操作。 